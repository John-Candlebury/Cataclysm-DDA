[
  {
    "id": "EOC_PERK_duelist_insert_reach",
    "type": "effect_on_condition",
    "eoc_type": "EVENT",
    "required_event": "gains_mutation",
    "condition": {
      "and": [
        { "compare_string": [ "MELEE_PERK_lunge_insert", { "context_val": "trait" } ] },
        {
          "or": [
            { "u_has_wielded_with_weapon_category": "LONG_THRUSTING_SWORDS" },
            { "u_has_wielded_with_weapon_category": "FENCING_WEAPONRY" }
          ]
        }
      ]
    },
    "effect": [
      {
        "u_run_inv_eocs": "all",
        "search_data": [ { "wielded_only": true } ],
        "true_eocs": [
          {
            "id": "_melee_perk_insert_reach",
            "effect": [
              {
                "if": { "not": { "npc_has_flag": "REACH_ATTACK" } },
                "then": [ { "npc_set_flag": "REACH_ATTACK" }, { "math": [ "n_duelist_reach_modified = 1" ] } ]
              }
            ]
          }
        ]
      },
      { "run_eocs": "EOC_PERK_duelist_remove_reach", "time_in_future": "1s" }
    ]
  },
  {
    "id": "EOC_PERK_duelist_remove_reach",
    "type": "effect_on_condition",
    "effect": [
      {
        "u_run_inv_eocs": "all",
        "search_data": [ { "condition": { "math": [ "n_duelist_reach_modified = 1" ] } } ],
        "true_eocs": [
          {
            "id": "_melee_perk_remove_reach",
            "effect": [ { "npc_unset_flag": "REACH_ATTACK" }, { "math": [ "n_duelist_reach_modified = 0" ] } ]
          }
        ]
      }
    ]
  }
]
